?facet_grid
alex_data %>% ggplot(aes(y = Thermal.C, x = Temp)) + geom_point() +
facet_grid(. ~ Id) + theme_classic()
alex_data %>% ggplot(aes(y = Thermal.C, x = Temp)) + geom_point() +
facet_grid(. ~ Id) + theme_bw()
alex_data %>% ggplot(aes(y = Thermal.C, x = Temp)) + geom_point(size = 1.5, col = "red2") +
facet_grid(. ~ Id) + theme_bw() + labs(x = "Temperature")
alex_data <- alex_data %>% dplyr::mutate(Id = case_when(
Longitude > 3.895 & latitude < 7.4525 ~ 1,
Longitude < 3.895 & Longitude >= 3.892056 & latitude > 7.4525 ~ 2,
!(Longitude > 3.895 & latitude < 7.4525) |
!( Longitude < 3.895 & Longitude >= 3.892056 & latitude > 7.4525) ~ 3
), M.C_logit = psych::logit(M.C) )
ggmap(get_map(location = c(lon, lat), zoom = 12, maptype = "toner")) +
geom_point(data = alex_data, aes(x = Longitude, y = latitude, col = Pb)) +
scale_colour_gradientn(colours = topo.colors(5))
ggmap(get_map(location = c(lon, lat), zoom = 12, maptype = "toner")) +
geom_point(data = alex_data, aes(x = Longitude, y = latitude, col = Pb)) +
scale_colour_gradientn(colours = topo.colors(5))
ggmap(get_map(location = c(lon, lat), zoom = 12))
install.packages("ggmap")
ggmap(get_map(location = c(lon, lat), zoom = 12, source = "google", maptype = "terrain"))
?get_map
ggmap(get_map())
ggmap(get_map(source = "stamen"))
install.packages("ggmap")
library(ggmap)
ggmap(get_map(location = c(lon, lat), zoom = 12, source = "google", maptype = "terrain")) +
geom_point(data = alex_data, aes(x = Longitude, y = latitude, col = Thermal.D)) +
scale_colour_gradientn(colours = topo.colors(5))
?register_google
ggmap(get_map(location = c(lon, lat), zoom = 12, source = "stamen", maptype = "terrain")) +
geom_point(data = alex_data, aes(x = Longitude, y = latitude, col = Thermal.D)) +
scale_colour_gradientn(colours = topo.colors(5))
install.packages("maps")
ggplot(data = alex_data, aes(x = Longitude, y = latitude, color = Thermal.D)) +
geom_point(size = 2, coclor = "brickred") + theme_bw()
alex_data %>% dplyr::filter(Id == 1 ) %>% ggplot(data = .,
aes(x = Longitude, y = latitude,
color = Thermal.D)) +
geom_point(size = 2) + theme_bw()
alex_data %>% ggplot(data = ., aes(x = Longitude, y = latitude,
color = as.factor(Id))) +
geom_point(size = 2) + theme_bw()
alex_data %>% dplyr::filter(Id == 2 ) %>% ggplot(data = .,
aes(x = Longitude, y = latitude,
color = Thermal.D)) +
geom_point(size = 2) + theme_bw()
alex_data %>% dplyr::filter(Id == 3 ) %>% ggplot(data = .,
aes(x = Longitude, y = latitude,
color = Thermal.D)) +
geom_point(size = 2) + theme_bw()
alex_data <- alex_data %>% dplyr::mutate(Id = case_when(
Longitude > 3.895 & latitude < 7.4525 ~ 1,
Longitude < 3.895 & Longitude >= 3.892056 & latitude > 7.4525 ~ 2,
!(Longitude < 3.895 & Longitude >= 3.892056 & latitude > 7.4525) ~ 3
), M.C_logit = psych::logit(M.C) )
library(tidyverse)
alex_data <- alex_data %>% dplyr::mutate(Id = case_when(
Longitude > 3.895 & latitude < 7.4525 ~ 1,
Longitude < 3.895 & Longitude >= 3.892056 & latitude > 7.4525 ~ 2,
!(Longitude < 3.895 & Longitude >= 3.892056 & latitude > 7.4525) ~ 3
), M.C_logit = psych::logit(M.C) )
alex_data %>% ggplot(data = ., aes(x = Longitude, y = latitude,
color = as.factor(Id))) +
geom_point(size = 2) + theme_bw()
alex_data %>% ggplot(data = ., aes(x = log(Longitude), y = log(latitude),
color = as.factor(Id))) +
geom_point(size = 2) + theme_bw()
alex_data %>% dplyr::filter(Id %in% c(2, 3) ) %>% ggplot(data = .,
aes(x = Longitude, y = latitude,
color = Thermal.D)) +
geom_point(size = 2) + theme_bw()
alex_data %>% dplyr::filter(Id %in% c(2) ) %>% ggplot(data = .,
aes(x = Longitude, y = latitude,
color = Thermal.D)) +
geom_point(size = 2) + theme_bw()
alex_data %>% dplyr::filter(Id %in% c(2) ) %>% ggplot(data = .,
aes(x = Longitude, y = latitude) +
geom_point(size = 2) + theme_bw()
alex_data %>% dplyr::filter(Id %in% c(2) ) %>% ggplot(data = .,
aes(x = Longitude, y = latitude)) +
geom_point(size = 2) + theme_bw()
alex_data %>% dplyr::filter(Id %in% c(3) ) %>% ggplot(data = .,
aes(x = Longitude, y = latitude)) +
geom_point(size = 2) + theme_bw()
alex_data %>% dplyr::filter(Id %in% c(1) ) %>% ggplot(data = .,
aes(x = Longitude, y = latitude)) +
geom_point(size = 2) + theme_bw()
alex_data <- alex_data %>% dplyr::mutate(Id = case_when(
Longitude > 3.895 & latitude < 7.4525 ~ 1,
Longitude < 3.895 & Longitude >= 3.892056 & latitude > 7.4525 ~ 2,
!(Longitude < 3.895 & Longitude >= 3.892056 & latitude > 7.4525) ~ 3
), M.C_logit = psych::logit(M.C) )
alex_data %>% ggplot(data = ., aes(x = Longitude, y = latitude,
color = as.factor(Id))) +
geom_point(size = 2) + theme_bw()
alex_data %>% ggplot(data = ., aes(x = Longitude, y = latitude,
color = as.factor(Id))) +
geom_point(size = 2) + theme_bw() + geom_jitter()
alex_data %>% ggplot(data = ., aes(x = Longitude, y = latitude)) +
geom_point(size = 2) + theme_bw() + facet_grid(Id ~ .)
alex_data %>% ggplot(data = ., aes(x = Longitude, y = latitude)) +
geom_point(size = 2) + theme_bw() + facet_grid(. ~ Id)
alex_data %>% ggplot(data = ., aes(x = Longitude, y = latitude)) +
geom_point(size = 2) + theme_bw() + facet_grid(. ~ Id) + geom_jitter()
?geom_jitter
alex_data %>% ggplot(data = ., aes(x = Longitude, y = latitude)) +
geom_point(size = 2) + theme_bw() + facet_grid(. ~ Id) + geom_jitter(width = 0.60)
alex_data %>% ggplot(data = ., aes(x = Longitude, y = latitude)) +
geom_point(size = 2) + theme_bw() + geom_jitter(width = 0.60)
ggplot(data = alex_data, aes(x = Longitude, y = latitude)) +
geom_point(size = 2) + theme_bw() + geom_jitter(width = 0.60) +
gganimate::transition_time(latitude) + labs(x = "Longitude", y = "Latitude")
ggplot(data = alex_data, aes(x = Longitude, y = latitude)) +
geom_point(size = 2) + theme_bw() + geom_jitter(width = 0.60) +
gganimate::transition_time(Longitude) + labs(x = "Longitude", y = "Latitude")
?gganimate::transition_time
alex_data <- alex_data %>% dplyr::mutate(Id = case_when(
latitude < 7.4525 ~ 1,
latitude >= 7.4525 & latitude <= 7.475 ~ 2,
latitude > 7.475 ~ 3
), M.C_logit = psych::logit(M.C) )
alex_data %>% ggplot(data = ., aes(x = Longitude, y = latitude,
color = as.factor(Id))) +
geom_point(size = 2) + theme_bw()
alex_data %>% ggplot(aes(y = Thermal.C, x = Temp)) + geom_point(size = 1.5, col = "red2") +
facet_grid(. ~ Id) + theme_bw() + labs(x = "Temperature")
alex_data %>% ggplot(aes(y = Thermal.C, x = Temp)) + geom_point(size = 1.5, col = "red2") +
facet_grid(. ~ Id) + theme_bw() + labs(x = "Temperature") + geom_jitter(width = 0.30)
alex_data %>% ggplot(aes(y = Thermal.C, x = Temp)) + geom_point(size = 1.5) +
facet_grid(. ~ Id) + theme_bw() + labs(x = "Temperature") + geom_jitter(width = 0.60)
alex_data %>% ggplot(aes(y = Thermal.C, x = Temp)) + geom_point(size = 1.5, color = "steelblue") +
facet_grid(. ~ Id) + theme_bw() + labs(x = "Temperature")
alex_data %>% ggplot(aes(y = Thermal.C, x = M.C)) + geom_point(size = 1.5, col = "red2") +
facet_grid(. ~ Id) + theme_bw() + labs(x = "Temperature")
alex_data %>% ggplot(aes(y = Thermal.C, x = Elevation)) + geom_point(size = 1.5, col = "red2") +
facet_grid(. ~ Id) + theme_bw() + labs(x = "Temperature")
alex_data %>% ggplot(aes(y = Thermal.C, x = Elevation)) + geom_point(size = 1.5, col = "red2") +
facet_grid(Id ~ ., scales = "fixed_y") + theme_bw() + labs(x = "Temperature")
alex_data %>% ggplot(aes(y = Thermal.C, x = Elevation)) + geom_point(size = 1.5, col = "red2") +
facet_grid(Id ~ ., scales = "fixed") + theme_bw() + labs(x = "Temperature")
alex_data %>% ggplot(aes(y = Thermal.C, x = Temp)) +
geom_point(aes(color = as.factor(Id)), size = 1.5) + theme_bw() + labs(x = "Temperature")
alex_data %>% ggplot(aes(y = Thermal.C, x = Temp)) +
geom_point(aes(color = as.factor(Id)), size = 1.5) + theme_bw() + labs(x = "Temperature") + geom_jitter(width = 0.60)
alex_data %>% ggplot(aes(y = Thermal.C, x = Temp)) +
geom_point(aes(color = as.factor(Id)), size = 1.5) + theme_bw() + labs(x = "Temperature") + geom_jitter(aes(color = as.factor(Id)), width = 0.60)
alex_data <- alex_data %>% dplyr::mutate(Id = case_when(
latitude < 7.4525 ~ 1,
latitude >= 7.4525 & latitude <= 7.475 ~ 2,
latitude > 7.475 ~ 3
), M.C_logit = psych::logit(M.C) ) %>% dplyr::mutate(Id2 = as.factor(Id))
alex_data %>% ggplot(data = ., aes(x = Longitude, y = latitude,
color = Id2)) +
geom_point(size = 2) + theme_bw()
?theme
alex_data %>% ggplot(data = ., aes(x = Longitude, y = latitude,
color = Id2)) +
geom_point(size = 2) + theme_bw() + theme(legend.title = "Cluster_Id")
alex_data %>% ggplot(data = ., aes(x = Longitude, y = latitude,
color = Id2)) +
geom_point(size = 2) + theme_bw() + labs(fill = "Cluster_Id")
?guides
alex_data %>% ggplot(data = ., aes(x = Longitude, y = latitude,
color = Id2)) +
geom_point(size = 2) + theme_bw() + labs(color = "Cluster_Id")
alex_data %>% ggplot(aes(y = Thermal.C, x = M.C)) +
geom_point(aes(color = Id2), size = 1.5) + theme_bw() +
labs(x = "Moisture Content", color = "Cluster_Id")
alex_data %>% ggplot(aes(y = Thermal.C, x = Elevation)) +
geom_point(aes(color = Id2), size = 1.5) + theme_bw() +
labs(x = "Elevation", color = "Cluster_Id")
alex_data %>% ggplot(aes(y = Thermal.D, x = Temp)) +
geom_point(aes(color = Id2), size = 1.5) + theme_bw() +
labs(x = "Temperature", color = "Cluster_Id")
alex_data %>% ggplot(aes(y = Thermal.D, x = M.C)) +
geom_point(aes(color = Id2), size = 1.5) + theme_bw() +
labs(x = "Moisture Content", color = "Cluster_Id")
alex_data %>% ggplot(aes(y = Thermal.D, x = Elevation)) +
geom_point(aes(color = Id2), size = 1.5) + theme_bw() +
labs(x = "Elevation", color = "Cluster_Id")
log(1)
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(tidyverse)
library(ggmap)
library(CAMAN)
library(rjags)
library(runjags)
library(gamlss)
library(psych)
alex_data <- read_csv("Data/data.csv", col_names = T)
#names(alex_data)
lat <- 7.451099
lon <- 3.896599
ggplot(data = alex_data, aes(x = Longitude, y = latitude)) +
geom_point(size = 2) + theme_bw() + geom_jitter(width = 0.60) +
labs(x = "Longitude", y = "Latitude")
alex_data <- alex_data %>% dplyr::mutate(Id = case_when(
latitude < 7.4525 ~ 1,
latitude >= 7.4525 & latitude <= 7.475 ~ 2,
latitude > 7.475 ~ 3
), M.C_logit = psych::logit(M.C) ) %>% dplyr::mutate(Id2 = as.factor(Id))
alex_data %>% ggplot(data = ., aes(x = Longitude, y = latitude,
color = Id2)) +
geom_point(size = 2) + theme_bw() + labs(color = "Cluster_Id")
alex_data %>% ggplot(aes(y = Thermal.C, x = Temp)) +
geom_point(aes(color = Id2), size = 1.5) + theme_bw() +
labs(x = "Temperature", color = "Cluster_Id")
alex_data %>% ggplot(aes(y = Thermal.C, x = M.C)) +
geom_point(aes(color = Id2), size = 1.5) + theme_bw() +
labs(x = "Moisture Content", color = "Cluster_Id")
alex_data %>% ggplot(aes(y = Thermal.C, x = Elevation)) +
geom_point(aes(color = Id2), size = 1.5) + theme_bw() +
labs(x = "Elevation", color = "Cluster_Id")
alex_data %>% ggplot(aes(y = Thermal.D, x = Temp)) +
geom_point(aes(color = Id2), size = 1.5) + theme_bw() +
labs(x = "Temperature", color = "Cluster_Id")
alex_data %>% ggplot(aes(y = Thermal.D, x = M.C)) +
geom_point(aes(color = Id2), size = 1.5) + theme_bw() +
labs(x = "Moisture Content", color = "Cluster_Id")
alex_data %>% ggplot(aes(y = Thermal.D, x = Elevation)) +
geom_point(aes(color = Id2), size = 1.5) + theme_bw() +
labs(x = "Elevation", color = "Cluster_Id")
alex_data %>% ggplot(aes(y = S.H, x = Temp)) +
geom_point(aes(color = Id2), size = 1.5) + theme_bw() +
labs(x = "Temperature", color = "Cluster_Id")
alex_data %>% ggplot(aes(y = S.H, x = M.C)) +
geom_point(aes(color = Id2), size = 1.5) + theme_bw() +
labs(x = "Moisture Content", color = "Cluster_Id")
alex_data %>% ggplot(aes(y = S.H, x = Elevation)) +
geom_point(aes(color = Id2), size = 1.5) + theme_bw() +
labs(x = "Elevation", color = "Cluster_Id")
families_thermalC <- c("NO", "GA", "LOGNO", "IGAMMA")
AICs <- sapply(families_thermalC, function(x) {
AIC(gamlss(Thermal.C~ Elevation + Temp + M.C,
data = alex_data, family = x))
})
knitr::kable(data.frame(Distribution = families_thermalC, AICs = AICs),
row.names = F, align = 'c')
families_S.H <- c("NO", "GA", "LOGNO", "IGAMMA")
AICs <- sapply(families_S.H, function(x) {
AIC(gamlss(S.H~ Elevation + Temp + M.C,
data = alex_data, family = x))
})
knitr::kable(data.frame(Distribution = families_S.H, AICs = AICs),
row.names = F, align = 'c')
families_thermalD <- c("NO", "GA", "LOGNO", "IGAMMA")
AICs <- sapply(families_thermalD, function(x) {
AIC(gamlss(Thermal.D~ Elevation + Temp + M.C,
data = alex_data, family = x))
})
knitr::kable(data.frame(Distribution = families_thermalD, AICs = AICs),
row.names = F, align = 'c')
alex_data1=alex_data[-17,]
AIC(gamlss(Thermal.D~ Elevation + Temp + M.C,
data = alex_data1, family = BE))
alex_data1=alex_data[-17,]
Thermal.D_logit= psych::logit(alex_data1$Thermal.D)
AIC(gamlss(Thermal.D_logit~ Elevation + Temp + M.C,
data = alex_data1, family = NO))
###normal assumption for Thermal.C
cat("
model{
#### #the normal likelihood for the data
for(i in 1: N){
mu[i] <-  beta[1] + beta[2]*Elevation[i] + beta[3]*Temp[i] + beta[4]*MC[i]
y[i] ~ dnorm(mu[i], tau)
res[i]=y[i]-mu[i]
}
#priors for the population parameters
#variance
tau <- pow(sigma_y, -2) #converting a precision
sigma_y ~ dunif(0, 20) #sampling a standard deviation
#prior for the betas
for(i in 1:4){
beta[i] ~ dnorm(0.0, 1.0E-5)
}
fit=(res[])
}",
file = "C:/Users/user/Documents/kas/sp/ThermalC_bayesian.bug")
thermalCdata <- list(N = nrow(alex_data),
y = alex_data$Thermal.C,
Elevation = alex_data$Elevation,
Temp = alex_data$Temp,
MC = alex_data$M.C
)
thermalCini <- list(list(beta = c(0.9, 0.002, 0.03, 1.59), sigma_y = 0.12),
list(beta = c(0.9, 0.002, 0.03, 1.59)/2, sigma_y = 0.12/2))
thermalC_bayesian <- run.jags(model = "C:/Users/user/Documents/kas/sp/ThermalC_bayesian.bug",
monitor=c("beta", "sigma_y","fit"),
data = thermalCdata, inits = thermalCini, n.chains = 2,
sample = 30000, burnin = 20000,
thin = 15, adapt = 40000,
method = "rjags", jags.refresh = 10)
thermalC_bayesian
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(tidyverse)
library(ggmap)
library(CAMAN)
library(rjags)
library(runjags)
library(gamlss)
library(psych)
alex_data <- read_csv("Data/data.csv", col_names = T)
#names(alex_data)
lat <- 7.451099
lon <- 3.896599
ggplot(data = alex_data, aes(x = Longitude, y = latitude)) +
geom_point(size = 2) + theme_bw() + geom_jitter(width = 0.60) +
labs(x = "Longitude", y = "Latitude")
alex_data <- alex_data %>% dplyr::mutate(Id = case_when(
latitude < 7.4525 ~ 1,
latitude >= 7.4525 & latitude <= 7.475 ~ 2,
latitude > 7.475 ~ 3
), M.C_logit = psych::logit(M.C) ) %>% dplyr::mutate(Id2 = as.factor(Id))
alex_data %>% ggplot(data = ., aes(x = Longitude, y = latitude,
color = Id2)) +
geom_point(size = 2) + theme_bw() + labs(color = "Cluster_Id")
alex_data %>% ggplot(aes(y = Thermal.C, x = Temp)) +
geom_point(aes(color = Id2), size = 1.5) + theme_bw() +
labs(x = "Temperature", color = "Cluster_Id")
alex_data %>% ggplot(aes(y = Thermal.C, x = M.C)) +
geom_point(aes(color = Id2), size = 1.5) + theme_bw() +
labs(x = "Moisture Content", color = "Cluster_Id")
alex_data %>% ggplot(aes(y = Thermal.C, x = Elevation)) +
geom_point(aes(color = Id2), size = 1.5) + theme_bw() +
labs(x = "Elevation", color = "Cluster_Id")
alex_data %>% ggplot(aes(y = Thermal.D, x = Temp)) +
geom_point(aes(color = Id2), size = 1.5) + theme_bw() +
labs(x = "Temperature", color = "Cluster_Id")
alex_data %>% ggplot(aes(y = Thermal.D, x = M.C)) +
geom_point(aes(color = Id2), size = 1.5) + theme_bw() +
labs(x = "Moisture Content", color = "Cluster_Id")
alex_data %>% ggplot(aes(y = Thermal.D, x = Elevation)) +
geom_point(aes(color = Id2), size = 1.5) + theme_bw() +
labs(x = "Elevation", color = "Cluster_Id")
alex_data %>% ggplot(aes(y = S.H, x = Temp)) +
geom_point(aes(color = Id2), size = 1.5) + theme_bw() +
labs(x = "Temperature", color = "Cluster_Id")
alex_data %>% ggplot(aes(y = S.H, x = M.C)) +
geom_point(aes(color = Id2), size = 1.5) + theme_bw() +
labs(x = "Moisture Content", color = "Cluster_Id")
alex_data %>% ggplot(aes(y = S.H, x = Elevation)) +
geom_point(aes(color = Id2), size = 1.5) + theme_bw() +
labs(x = "Elevation", color = "Cluster_Id")
families_thermalC <- c("NO", "GA", "LOGNO", "IGAMMA")
AICs <- sapply(families_thermalC, function(x) {
AIC(gamlss(Thermal.C~ Elevation + Temp + M.C,
data = alex_data, family = x))
})
knitr::kable(data.frame(Distribution = families_thermalC, AICs = AICs),
row.names = F, align = 'c')
families_S.H <- c("NO", "GA", "LOGNO", "IGAMMA")
AICs <- sapply(families_S.H, function(x) {
AIC(gamlss(S.H~ Elevation + Temp + M.C,
data = alex_data, family = x))
})
knitr::kable(data.frame(Distribution = families_S.H, AICs = AICs),
row.names = F, align = 'c')
families_thermalD <- c("NO", "GA", "LOGNO", "IGAMMA")
AICs <- sapply(families_thermalD, function(x) {
AIC(gamlss(Thermal.D~ Elevation + Temp + M.C,
data = alex_data, family = x))
})
knitr::kable(data.frame(Distribution = families_thermalD, AICs = AICs),
row.names = F, align = 'c')
alex_data1=alex_data[-17,]
AIC(gamlss(Thermal.D~ Elevation + Temp + M.C,
data = alex_data1, family = BE))
alex_data1=alex_data[-17,]
Thermal.D_logit= psych::logit(alex_data1$Thermal.D)
AIC(gamlss(Thermal.D_logit~ Elevation + Temp + M.C,
data = alex_data1, family = NO))
###normal assumption for Thermal.C
cat("
model{
#### #the normal likelihood for the data
for(i in 1: N){
mu[i] <-  beta[1] + beta[2]*Elevation[i] + beta[3]*Temp[i] + beta[4]*MC[i]
y[i] ~ dnorm(mu[i], tau)
res[i]=y[i]-mu[i]
}
#priors for the population parameters
#variance
tau <- pow(sigma_y, -2) #converting a precision
sigma_y ~ dunif(0, 20) #sampling a standard deviation
#prior for the betas
for(i in 1:4){
beta[i] ~ dnorm(0.0, 1.0E-5)
}
fit=(res[])
}",
file = "C:/Users/user/Documents/kas/sp/ThermalC_bayesian.bug")
thermalCdata <- list(N = nrow(alex_data),
y = alex_data$Thermal.C,
Elevation = alex_data$Elevation,
Temp = alex_data$Temp,
MC = alex_data$M.C
)
thermalCini <- list(list(beta = c(0.9, 0.002, 0.03, 1.59), sigma_y = 0.12),
list(beta = c(0.9, 0.002, 0.03, 1.59)/2, sigma_y = 0.12/2))
thermalC_bayesian <- run.jags(model = "C:/Users/user/Documents/kas/sp/ThermalC_bayesian.bug",
monitor=c("beta", "sigma_y","fit"),
data = thermalCdata, inits = thermalCini, n.chains = 2,
sample = 30000, burnin = 20000,
thin = 15, adapt = 40000,
method = "rjags", jags.refresh = 10)
#Bayesian random effect model for MC (spatial correlation treated via accounting for clustering)
alex_data <- alex_data[order(alex_data$Id),]
#normal assumption for thermal C
cat("
model{
#### #the normal likelihood for the data
for(i in 1: N){
mu[i] <-  beta[1] + beta[2]*Elevation[i] + beta[3]*Temp[i] + beta[4]*MC[i] + b[Id[i]]
tau[i] <- pow(sig[i], -2)
y[i] ~ dlnorm(mu[i], tau[i])
res[i]=y[i]-mu[i]
}
#the cluster random effects
for(j in 1:J){
b[j] ~ dnorm(beta[1], tau.b)
}
#priors for the population parameters
#prior for the betas
for(i in 1:4){
beta[i] ~ dnorm(0.0, 1.0E-5)
}
#priors for the population parameters
#variance
tau <- pow(sigma_y, -2) #converting a precision
sigma_y ~ dunif(0, 20) #sampling a standard deviation
#prior for the random effect parameters
#variance between clusters
tau.b <- pow(sigma.b, -2) #converting it to a precision
sigma.b ~ dunif(0, 20) #sampling a standard deviation
###Intra cluster correlation
#cluster
icc = sigma_y / (sigma.b + sigma_y)
######fit resiuals###########
fit=res[]}", file =  "C:/Users/user/Documents/kas/sp/ThermalC_bayesian.bug")
thermalCdata <- list(N = nrow(alex_data),
y = alex_data$Thermal.C,
Elevation = alex_data$Elevation,
Temp = alex_data$Temp,
MC = alex_data$M.C,
J = length(unique(alex_data$Id))
)
thermalCini <- list(list(beta = c(0.9, 0.002, 0.03, 1.59), sigma_y = 0.12, sigma.b = 0.12),
list(beta = c(0.9, 0.002, 0.03, 1.59)/2, sigma_y = 0.12/2, sigma.b = 0.12/2))
thermalC_bayesian <- run.jags(model =  "C:/Users/user/Documents/kas/sp/ThermalC_bayesian.bug",
monitor=c("beta", "sigma_y", "sigma.b", "icc", "fit"),
data = thermalCdata, inits = thermalCini, n.chains = 2,
sample = 50000, burnin = 50000,
thin = 15, adapt = 40000,
method = "rjags", jags.refresh = 10)
#Alex Analysis
library(readr)
library(tidyverse)
library(ggmap)
library(CAMAN)
library(rjags)
library(runjags)
library(gamlss)
setwd("C:/Users/user/Documents/kas/sp")
alex_data<-read.csv("data.csv",header = T)
names(alex_data)
lat <- 7.451099
lon <- 3.896599
###creating indicators for the different clusters
alex_data <- alex_data %>% dplyr::mutate(Id = if_else(Longitude > 3.895 & latitude < 7.4525, 1,
if_else(Longitude < 3.895 & Longitude >= 3.892056 &
latitude > 7.4525, 2, 3)),
M.C_logit = psych::logit(M.C) )
library(tidyverse)
library(ggmap)
library(CAMAN)
library(psych)
library(ggplot2)
library(runjags)
library(rjags)
setwd("C:/Users/user/Documents/kas/variogram")
alex_
###normal assumption for S.H
cat("
model{
#### #the normal likelihood for the data
for(i in 1: N){
mu[i] <-  beta[1] + beta[2]*Elevation[i] + beta[3]*Temp[i] + beta[4]*MC[i]
y[i] ~ dlnorm(mu[i], tau)
res[i]=y[i]-mu[i]
}
#priors for the population parameters
#variance
tau <- pow(sigma_y, -2) #converting a precision
sigma_y ~ dunif(0, 20) #sampling a standard deviation
#prior for the betas
for(i in 1:4){
beta[i] ~ dnorm(0.0, 1.0E-5)
}
fit=(res[])
}",
file = "C:/Users/user/Documents/kas/sp/ThermalC_bayesian.bug")
thermalCdata <- list(N = nrow(alex_data),
y = alex_data$Thermal.C,
Elevation = alex_data$Elevation,
Temp = alex_data$Temp,
MC = alex_data$M.C
)
